# Docker
## 安装
[官方文档](https://docs.docker.com/docker-for-windows/install/#install-docker-for-windows)

## 新的开发流程
* 开发人员开发，提交代码到代码服务器（Github，BitBucket，Gitlab等）
* 代码服务器通过webhook调用CI/CD服务，如Codeship，Shippable，CircleCI或者自建Jenkins等。
* CI服务器下载最新代码，构建Docker镜像，并进行测试。
* 自动集成测试通过之后，就可以将之前构建的镜像推送到私有Registry。
* 运维使用新版的Docker镜像进行部署。

## Docker组件
镜像是构建Docker世界的基石。用户基于镜像来运行自己的容器。镜像可以被创建，启动，关闭，重启以及销毁。
**我们可以架设自己的私有Registry**。
镜像是Docker生命周期中的构建或打包阶段，而容器则是启动或执行阶段。
容器拥有自己的网路，IP地址，以及一个用来和宿主机进行通信的桥接网络接口。

## 我们能用Docker做什么
* 加速本地开发和构建流程，使其更加高效，更加轻量化。本地开发人员可以构建，运行并分享Docker容器。
   容器可以在开发环境中构建，然后轻松地提交到测试环境中，并最终进入生产环境。
* 能够让独立服务或应用程序在不同的环境中，得到相同的运行结果。
* 用Docker创建隔离的环境来进行测试。例如，用JenkinsCI这样的持续集成工具启动一个用于测试的容器。
* Docker可以让开发者先在本机上构建一个复杂的程序或架构来进行测试，而不是一开始就在生产环境部署，测试。
* 构建一个多用户的平台即服务(PaaS)基础设施。
* 为开发，测试提供一个轻量级的独立沙盒环境，或者将独立的沙盒环境用于技术教学，如Unix shell的使用，编程语言教学。
* 提供软件即服务(SaaS)应用程序，如Memcached即服务。
* 高性能，超大规模的宿主机部署。

## Docker入门
* docker info
    该命令会返回所有容器和镜像的数量，Docker使用的执行驱动和存储驱动，以及Docker的基础配置。
* docker run 运行容器
    这个命令会检查本地是否存在ubuntu镜像，如果本地还没有该镜像的话，那么Docker就会链接官方维护的Docker Hub Registry,
    查看Docker Hub中是否有该镜像。Docker一旦找到该镜像，就会下载该镜像并将其保存到本地宿主机中。
    参数 -i: 保证容器中STDIN是开启的。
    参数 -t: 告诉Docker为创建的容器分配一个伪tty终端。
    **若要在命令行下创建一个我们能与之进行交互的容器，而不是一个运行后台服务的容器，则这两个参数已经是最基本的参数了**。
    **下面是创建守护式容器的方法**
    参数-d: Docker会将容器放到后台运行。这样变成守护式容器。守护式容器没有交互式会话，非常适合运行应用程序和服务。大多数时候我们都需要以守护式来运行我们的容器。 
    
    --name <name>:为容器命名。一个合法的容器名称只能包含以下字符：小写字母a-z，大写字母A-Z，数字0-9，下划线，圆点，横线。（正则表达式:[a-zA-Z0-9_.-]）
    --restart: 自动重启容器。--restart=always：无论容器的退出代码是什么，Docker都会自动重启容器。除了always，我们还可以将这个标志设为on-failure，
                   这样，只有当容器的退出代码为非0值的时候，才会自动重启。另外on-failure还接受一个可选的重启次数参数。--restart=on-failure:5,这样但容器退出代码为非0时，Docker会尝试自动重启容器，最多重启5次。
* docker start <容器名/容器ID>
    重新启动一个已经停止的容器
* docker restart  <容器名/容器ID>
    重新启动一个容器。
* docker attach <容器名/容器ID>  
    附着到该容器的会话上。 
* docker ps  
    默认情况下，当执行docker ps命令时，只能看到正在运行的容器。    
    -a : 查看当前系统中容器（包括正在运行的和已经停止的）的列表。   
    -n x: 会显示最后x个容器，不论这些容器正在运行还是已经停止。   
    -q: 表示只需要返回容器的ID而不会返回容器的其他信息。   
* docker logs <容器名/容器ID>
    查看容器内部都在干些什么。可以通过Ctrl+C退出日志跟踪。  
    参数-f: 来监控Docker的日志，这与tail -f命令非常相似。  
    参数--tail <number>:可以跟踪容器日志的某一片段。例如docker logs --tail 10 -f daemon_dave命令来跟踪某个容器的最新日志而不必读取整个日志文件。  
    参数-t: 为每条日志项加上时间戳。
* docker top  <容器名/容器ID>   
    查看容器内的进程。  
* docker exec <容器名/容器ID> （Docker1.3以上）  
    在容器内部额外启动新进程。  
* docker stop <容器名/容器ID>  
    停止守护式容器。  
* docker inspect <容器名/容器ID>   
    获取容器更多的信息，返回容器的配置信息，包括名称，命令，网络配置以及很多有用的数据。  
    -f或者--format: 来选定查看结果。  
* docker rm  <容器名/容器ID>  
    删除容器。需要注意的是，运行中的Docker容器是无法删除的！你必须先通过docker stop或docker kill命令停止容器，才能将其删除。  
    可以通过docker rm \`docker ps -a -q\`来一次性删除所有的容器。  